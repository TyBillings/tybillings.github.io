<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="description" content="A FreeRangeZoo extension for Openness">
    <meta property="og:title" content="free-range-zoo Documentation" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="A FreeRangeZoo extension for Openness" />
    <meta property="og:url" content="None" /><meta name="twitter:card" content="summary_large_image"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Wildfire" href="../environments/wildfire/index.html" /><link rel="prev" title="Basic Usage" href="../introduction/basic_usage.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2023.08.19.dev1 -->
        <title>Environment API - free-range-zoo Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=3e7f4c72" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=49cbaffd" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <header class="farama-header" aria-label="Farama header">
      <div class="farama-header__container">
        <div class="farama-header__left--mobile">
          <label class="nav-overlay-icon" for="__navigation">
            <div class="visually-hidden">Toggle site navigation sidebar</div>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <defs></defs>
              <line x1="0.5" y1="4" x2="23.5" y2="4"></line>
              <line x1="0.232" y1="12" x2="23.5" y2="12"></line>
              <line x1="0.232" y1="20" x2="23.5" y2="20"></line>
            </svg>
          </label>
        </div>
        <div class="farama-header__left farama-header__center--mobile">
          <a href="../index.html">
              <img class="farama-header__logo only-light" src="../_static/img/darkgoat.png" alt="Light Logo"/>
              <img class="farama-header__logo only-dark" src="../_static/img/lightgoat.png" alt="Dark Logo"/>
            <span class="farama-header__title">free-range-zoo Documentation</span>
          </a>
        </div>
        <div class="farama-header__right">
          <div class="farama-header-menu">
              <!-- Fork of the Celshast template from the Farama Foundation  (breaks the header like this will reconsider attribution later) -->
          </div>
        </div>
      </div>
    </header>

    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="page">
  <!--<header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">free-range-zoo Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>-->
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="farama-sidebar__title" href="../index.html">
      <img class="farama-header__logo only-light" src="../_static/img/darkgoat.png" alt="Light Logo"/>
      <img class="farama-header__logo only-dark" src="../_static/img/lightgoat.png" alt="Dark Logo"/>
    <span class="farama-header__title">free-range-zoo Documentation</span>
  </a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/basic_usage.html">Basic Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Environment API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/wildfire/index.html">Wildfire</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Wildfire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/wildfire/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/wildfire/baselines.html">Baselines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/cybersecurity/index.html">Cybersecurity</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Cybersecurity</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/cybersecurity/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/cybersecurity/baselines.html">Baselines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/rideshare/index.html">Rideshare</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Rideshare</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/rideshare/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/rideshare/baselines.html">Baselines</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/oasys-mas/free-range-zoo">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main-container">

    

    

    <div class="main">
      <div class="content">
        <div class="article-container">
          <a href="#" class="back-to-top muted-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
            </svg>
            <span>Back to top</span>
          </a>
          <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
              <button class="theme-toggle" title="Toggle color theme">
                <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                <svg class="theme-icon-when-auto">
                  <use href="#svg-sun-half"></use>
                </svg>
                <svg class="theme-icon-when-dark">
                  <use href="#svg-moon"></use>
                </svg>
                <svg class="theme-icon-when-light">
                  <use href="#svg-sun"></use>
                </svg>
              </button>
            </div>
            <label class="toc-overlay-icon toc-content-icon" for="__toc">
              <div class="visually-hidden">Toggle table of contents sidebar</div>
              <i class="icon"><svg>
                  <use href="#svg-toc"></use>
                </svg></i>
            </label>
          </div>
          <article role="main">
            
            <section class="tex2jax_ignore mathjax_ignore" id="environment-api">
<h1>Environment API<a class="headerlink" href="#environment-api" title="Link to this heading">¶</a></h1>
<p>Our environments differ slightly from <code class="docutils literal notranslate"><span class="pre">pettingzoo</span></code> in two aspects. Our environments operate in vectorized <strong>batches</strong>.
The intention of this is to take advantage of batched computation provided by <strong>SIMD</strong> architectures, and allow for
multithreaded operations to make environment transitions faster. Additionally, our environments use standard
<code class="docutils literal notranslate"><span class="pre">Configuration</span></code> objects to organize environment parameters.</p>
<hr class="docutils" />
<section id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading">¶</a></h2>
<p>Each environment follows the same directory structure for defining environment dynamics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>envs
├── &lt;environment&gt;               #   &lt;Environment implementation&gt;
│   ├── configs                 #       Benchmark configurations
│   └── env                     #       Environment definitions
│       ├── spaces              #           Action / observation spaces
│       ├── structures          #
|       | |_ configuration.py   #           &quot;Configuration&quot; for env settings
|       | |_ state.py           #           &quot;State&quot; class to store curr state
│       ├── transitions         #           Environment transition functions
│       ├── utils               #           Misc. tools
│       └── &lt;environment&gt;.py    #       Main environment definition
└── &lt;environment&gt;_vX.py         # Environment import file
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="importing-environments">
<h2>Importing Environments<a class="headerlink" href="#importing-environments" title="Link to this heading">¶</a></h2>
<p>The method for importing environments for utilization is identical to <code class="docutils literal notranslate"><span class="pre">pettingzoo</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># free-range-zoo</span>
<span class="kn">from</span> <span class="nn">free_range_zoo.envs</span> <span class="kn">import</span> <span class="n">wildfire_v0</span>

<span class="c1"># vs. pettingzoo</span>
<span class="kn">from</span> <span class="nn">pettingzoo.butterfly</span> <span class="kn">import</span> <span class="n">pistonball_v6</span>
</pre></div>
</div>
<p>The environment can then be used in a manner similar to <code class="docutils literal notranslate"><span class="pre">pettingzoo</span></code> environements.</p>
</section>
<hr class="docutils" />
<section id="configuring-environments">
<h2>Configuring Environments<a class="headerlink" href="#configuring-environments" title="Link to this heading">¶</a></h2>
<p>In order to make environments more flexible and parameterize transition functions, <code class="docutils literal notranslate"><span class="pre">free-range-zoo</span></code> utilizes
<code class="docutils literal notranslate"><span class="pre">Configuration</span></code> classes to group parameters for the environment. Each environment’s respective
<code class="docutils literal notranslate"><span class="pre">Configuration</span></code> objects and structure are documented in their <strong>Specification</strong> page, and implementations
are included in <code class="docutils literal notranslate"><span class="pre">envs/&lt;environment_name&gt;/env/structures/configuration.py</span></code>.</p>
<!--TODO: Add in the link for generator documentation-->
<p>For simplicity, generators for configurations have been included with the competition materials. Configuration
generators for each environment are documented <a class="reference internal" href="#"><span class="xref myst">here</span></a>.</p>
<p>Each environment module exposes two methods <code class="docutils literal notranslate"><span class="pre">parallel_env()</span></code> and <code class="docutils literal notranslate"><span class="pre">aec_env()</span></code>. <code class="docutils literal notranslate"><span class="pre">parallel_env</span></code> is more commonly used and
follows the Parallel AEC loop where all agent actions are submitted simultaneously.</p>
<p>Both functions take in several parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">configuration</span></code>: <code class="docutils literal notranslate"><span class="pre">Configuration</span></code> - the configuration object for the environment to use at initialization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parallel_envs</span></code>: <code class="docutils literal notranslate"><span class="pre">int</span></code> - the number of parallel episodes to run simultaneously within the environment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_steps</span></code>: <code class="docutils literal notranslate"><span class="pre">int</span></code> - the number of environment steps to run before termination. <code class="docutils literal notranslate"><span class="pre">wildfire</span></code> has extra termination
criteria.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">device</span></code>: <code class="docutils literal notranslate"><span class="pre">torch.DeviceObjType</span></code> - the device to use for environment data storage and processing. All outputs from
the environment will also be on this device.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">single_seeding</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Whether all environment parameters should operate on a single seed. This parallelizes
random generation across environments rather than having each environment have its own seed. This significantly
increases speed for each environment step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">buffer_size</span></code>: <code class="docutils literal notranslate"><span class="pre">int</span></code> - The size of the buffer for random generation. Generally this should be set to the value of
<code class="docutils literal notranslate"><span class="pre">max_steps</span> <span class="pre">*</span> <span class="pre">parallel_envs</span></code> to make it so that random generation is only done once per complete episode.</p></li>
</ul>
<p>There are additional parameters available in each environment file. Note that action space and observability parameters
will be kept on the default values during evaluation, so it is advised that the same is done during training so that
observations are kept consistent with evaluation.</p>
<!--TODO: Add in the link for the environment usage documentation-->
<p>To see more details about how to interact with environments, see <a class="reference internal" href="#"><span class="xref myst">Environment Usage</span></a>.</p>
</section>
<hr class="docutils" />
<section id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Link to this heading">¶</a></h2>
<p>Actions in <code class="docutils literal notranslate"><span class="pre">free-range-zoo</span></code> have a consistent structure, however must be represented in a way that is compatible with
<strong>task openness</strong>. Actions have two categories, <strong>task actions</strong>, which are represented by the action input
<code class="docutils literal notranslate"><span class="pre">(task</span> <span class="pre">id,</span> <span class="pre">action</span> <span class="pre">id)</span></code>, where action id is subject to change based on what actions are available to the agent. The
other category is <strong>task agnostic actions</strong>, which are represented by action input <code class="docutils literal notranslate"><span class="pre">(padding,</span> <span class="pre">action</span> <span class="pre">id)</span></code>. Action ids
for task agnostic actions are always consistent and always negative.</p>
<p>The reason why we represent action spaces in this way is due to having an unbounded number of tasks due to <strong>task
openness</strong>. In order to handle this, action spaces are non-static and must grow and shrink during execution in order
to accomodate additional tasks.</p>
<p><strong>Task agnostic actions</strong> represent actions for which the association with an individual task is not known. An example
of this would be <code class="docutils literal notranslate"><span class="pre">noop</span></code> in all domains. <code class="docutils literal notranslate"><span class="pre">noop</span></code> has an effect within the environment, however that effect is independent
from any individual task. <strong>Task actions</strong> are actions with which a direct relationship can be drawn between the task
and the associated action. For example, <code class="docutils literal notranslate"><span class="pre">pick</span></code> within rideshare has a clear association with an inidividual task, and
thus must be targeted towards a specific task.</p>
</section>
<hr class="docutils" />
<section id="additional-useful-attributes">
<h2>Additional Useful Attributes<a class="headerlink" href="#additional-useful-attributes" title="Link to this heading">¶</a></h2>
<section id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">reset(seed:</span> <span class="pre">List[int],</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code>: Used for resetting the environment state to the initial state defined on
initialization by <code class="docutils literal notranslate"><span class="pre">configuration</span></code>. Takes initial seeds for each environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">step(actions:</span> <span class="pre">torch.Tensor,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code>: Used to advance the entire environment a single step. Actions must be
provided in the form of <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> with shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs,</span> <span class="pre">2)</span></code>, where element (1) of the actions represents the
task which the agent is acting on, and (2) represents the action taken on that task.</p>
<p><code class="docutils literal notranslate"><span class="pre">action_space(agent:</span> <span class="pre">str)</span></code>: Used to retrieve the action space of <code class="docutils literal notranslate"><span class="pre">agent</span></code>. Will return spaces which are similar to
<code class="docutils literal notranslate"><span class="pre">gymnasium.Space</span></code> objects, but provide faster functionality.</p>
<p><code class="docutils literal notranslate"><span class="pre">observation_space(agent:</span> <span class="pre">str)</span></code>: Used to retrieve the observation space of <code class="docutils literal notranslate"><span class="pre">agent</span></code>. Will return spaces which are similar to
<code class="docutils literal notranslate"><span class="pre">gymnasium.Space</span></code> objects, but provide faster functionality.</p>
<p><code class="docutils literal notranslate"><span class="pre">state()</span></code>: Used to retrive the current state of the environment. <code class="docutils literal notranslate"><span class="pre">State</span></code> will be the vectorized state of all parallel
environments at the time of execution.</p>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">agents</span></code>: The list of all agents names in all environments.</p>
<p><code class="docutils literal notranslate"><span class="pre">agent_name_mapping</span></code>: The mapping of agent names to agent indices for all environments.</p>
<p><code class="docutils literal notranslate"><span class="pre">environment_task_count</span></code>: An <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> representing the number of tasks currently present in each parallel environment.
The tensor has the shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">agent_task_count</span></code>: An <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> reprsenting the number of tasks available to each agent. Holds the form
<code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">IntTensor]</span></code> and is keyed by agent name, where <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> has shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">task_store</span></code>: A ragged tensor of the task observations for all environments. Individualized per environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">agent_action_mapping</span></code>: A mapping of task indices from an agent’s action space to <code class="docutils literal notranslate"><span class="pre">task_store</span></code>. This is used to map actions
from an individual agent’s action space back to the global task store. Holds the form of <code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">IntTensor]</span></code> and is keyed
by agent name, where <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> is ragged, of shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs,</span> <span class="pre">tasks)</span></code> and is representative of indices in
<code class="docutils literal notranslate"><span class="pre">task_store</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">agent_observation_mapping</span></code>: A mapping of task indices from an agent’s observation space to <code class="docutils literal notranslate"><span class="pre">task_store</span></code>. This is used to
map observations from an individual agent’s observation space back to the global task store. Holds the form of
<code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">IntTensor]</span></code> and is keyed by agent name, where <code class="docutils literal notranslate"><span class="pre">IntTensor</span></code> is ragged, of shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs,</span> <span class="pre">tasks)</span></code> and
is representative of indices in <code class="docutils literal notranslate"><span class="pre">task_store</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">terminated</span></code>: A dict of termination state of every current agent in every environment at the time called. The returned
dict is keyed by agent name and returns a <code class="docutils literal notranslate"><span class="pre">BoolTensor</span></code> of the termination state of the agent in each parallel
environment. The inner tensors have the shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">truncated</span></code>: A dict of trunctation state of every current agent in every environment at the time called. The returned
dict is keyed by agent name and returns a <code class="docutils literal notranslate"><span class="pre">BoolTensor</span></code> of the truncation state of the agent in each parallel
environment. The inner tensors have the shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">finished</span></code>: A dict of <code class="docutils literal notranslate"><span class="pre">terminated</span> <span class="pre">|</span> <span class="pre">truncated</span></code>. Holds the same form as <code class="docutils literal notranslate"><span class="pre">terminated</span></code> and <code class="docutils literal notranslate"><span class="pre">truncated</span></code>. The inner tensors have the shape <code class="docutils literal notranslate"><span class="pre">(parallel_envs)</span></code>.</p>
</section>
</section>
</section>

          </article>
        </div>
        <footer>
          
          <div class="related-pages">
            <a class="next-page" href="../environments/wildfire/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Wildfire</div>
              </div>
              <svg class="furo-related-icon">
                <use href="#svg-arrow-right"></use>
              </svg>
            </a>
            <a class="prev-page" href="../introduction/basic_usage.html">
              <svg class="furo-related-icon">
                <use href="#svg-arrow-right"></use>
              </svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Basic Usage</div>
                
              </div>
            </a>
          </div>
          <div class="bottom-of-page">
            <div class="left-details">
              <div class="copyright">
                Copyright &#169; 1980, University of Georgia, University of Nebraska, Oberlin College
              </div>
              <!--
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            -->
            </div>
            <div class="right-details">
              <div class="icons">
                
              </div>
            </div>
          </div>
          
        </footer>
      </div>
      <aside class="toc-drawer">
        
        
        <div class="toc-sticky toc-scroll">
          <div class="toc-title-container">
            <span class="toc-title">
              On this page
            </span>
          </div>
          <div class="toc-tree-container">
            <div class="toc-tree">
              <ul>
<li><a class="reference internal" href="#">Environment API</a><ul>
<li><a class="reference internal" href="#directory-structure">Directory Structure</a></li>
<li><a class="reference internal" href="#importing-environments">Importing Environments</a></li>
<li><a class="reference internal" href="#configuring-environments">Configuring Environments</a></li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#additional-useful-attributes">Additional Useful Attributes</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
        
        
      </aside>
    </div>
  </div>
</div>
    <!-- <script>
      const toggleMenu = () => {
        const menuBtn = document.querySelector(".farama-header-menu__btn");
        const menuContainer = document.querySelector(".farama-header-menu-container");
        if (document.querySelector(".farama-header-menu").classList.contains("active")) {
          menuBtn.setAttribute("aria-expanded", "false");
          menuContainer.setAttribute("aria-hidden", "true");
        } else {
          menuBtn.setAttribute("aria-expanded", "true");
          menuContainer.setAttribute("aria-hidden", "false");
        }
        document.querySelector(".farama-header-menu").classList.toggle("active");
      }

      document.querySelector(".farama-header-menu__btn").addEventListener("click", toggleMenu);
      document.getElementById("farama-close-menu").addEventListener("click", toggleMenu);
    </script> -->

    
    

    <script src="../_static/documentation_options.js?v=c5e1e573"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=7660844c"></script>
    
    <!--
    <script>

      const createProjectsList = (projects, displayImages) => {
        const ulElem = Object.assign(document.createElement('ul'),
          {
            className:'farama-header-menu-list',
          }
        )
        for (let project of projects) {
          const liElem = document.createElement("li");
          const aElem = Object.assign(document.createElement("a"),
            {
              href: project.link
            }
          );
          liElem.appendChild(aElem);
          if (displayImages) {
            const imgElem = Object.assign(document.createElement("img"),
              {
                src: project.image ? imagesBasepath + project.image : imagesBasepath + "/farama_black.svg",
                alt: `${project.name} logo`,
                className: "farama-black-logo-invert"
              }
            );
            aElem.appendChild(imgElem);
          }
          aElem.appendChild(document.createTextNode(project.name));
          ulElem.appendChild(liElem);
        }
        return ulElem;
      }

      // Create menu with Farama projects by using the API at farama.org/api/projects.json
      const createCORSRequest = (method, url) => {
        let xhr = new XMLHttpRequest();
        xhr.responseType = 'json';

        if ("withCredentials" in xhr) {
          xhr.open(method, url, true);
        } else if (typeof XDomainRequest != "undefined") {
          // IE8 & IE9
          xhr = new XDomainRequest();
          xhr.open(method, url);
        } else {
          // CORS not supported.
          xhr = null;
        }
        return xhr;
      };

      const url = 'https://farama.org/api/projects.json';
      const imagesBasepath = "https://farama.org/assets/images"
      const method = 'GET';
      let xhr = createCORSRequest(method, url);

      xhr.onload = () => {
        const jsonResponse = xhr.response;
        const sections = {
          "Core Projects": [],
          "Mature Projects": {
            "Documentation": [],
            "Repositories": [],
          },
          "Incubating Projects": {
            "Documentation": [],
            "Repositories": [],
          },
          "Foundation": [
            {
              name: "About",
              link: "https://farama.org/about"
            },
            {
              name: "Standards",
              link: "https://farama.org/project_standards",
            },
            {
              name: "Donate",
              link: "https://farama.org/donations"
            }
          ]
        }

        // Categorize projects
        Object.keys(jsonResponse).forEach(key => {
          projectJson = jsonResponse[key];
          if (projectJson.website !== null) {
            projectJson.link = projectJson.website;
          } else {
            projectJson.link = projectJson.github;
          }
          if (projectJson.type === "core") {
            sections["Core Projects"].push(projectJson)
          } else if (projectJson.type == "mature") {
            if (projectJson.website !== null) {
              sections["Mature Projects"]["Documentation"].push(projectJson)
            } else {
              sections["Mature Projects"]["Repositories"].push(projectJson)
            }
          } else {
            if (projectJson.website !== null) {
              sections["Incubating Projects"]["Documentation"].push(projectJson)
            } else {
              sections["Incubating Projects"]["Repositories"].push(projectJson)
            }
          }
        })

        const menuContainer = document.querySelector(".farama-header-menu__body");

        Object.keys(sections).forEach((key, i) => {
          const sectionElem = Object.assign(
            document.createElement('div'), {
              className:'farama-header-menu__section',
            }
          )
          sectionElem.appendChild(Object.assign(document.createElement('span'),
            {
              className:'farama-header-menu__section-title' ,
              innerText: key
            }
          ))
          // is not a list
          if (sections[key].constructor !== Array) {
            const subSections = sections[key];
            const subSectionContainerElem = Object.assign(
                document.createElement('div'), {
                  className:'farama-header-menu__subsections-container',
                  style: 'display: flex'
                }
            )
            Object.keys(subSections).forEach((subKey, i) => {
              const subSectionElem = Object.assign(
                document.createElement('div'), {
                  className:'farama-header-menu__subsection',
                }
              )
              subSectionElem.appendChild(Object.assign(document.createElement('span'),
                {
                  className:'farama-header-menu__subsection-title' ,
                  innerText: subKey
                }
              ))
              const ulElem = createProjectsList(subSections[subKey], key !== 'Foundation');
              subSectionElem.appendChild(ulElem);
              subSectionContainerElem.appendChild(subSectionElem);
            })
            sectionElem.appendChild(subSectionContainerElem);
          } else {
            const projects = sections[key];
            const ulElem = createProjectsList(projects, true);
            sectionElem.appendChild(ulElem);
          }
          menuContainer.appendChild(sectionElem)
        });
      }

      xhr.onerror = function() {
        console.error("Unable to load projects");
      };

      xhr.send();
    </script>
  -->

    
    

    </body>
</html>