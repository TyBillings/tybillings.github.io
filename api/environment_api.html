<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="description" content="A FreeRangeZoo extension for Openness">
    <meta property="og:title" content="free-range-zoo Documentation" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="A FreeRangeZoo extension for Openness" />
    <meta property="og:url" content="None" /><meta name="twitter:card" content="summary_large_image"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Wildfire" href="../environments/wildfire/index.html" /><link rel="prev" title="Environment API" href="environments.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2023.08.19.dev1 -->
        <title>Environment API - free-range-zoo Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=3e7f4c72" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=49cbaffd" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <header class="farama-header" aria-label="Farama header">
      <div class="farama-header__container">
        <div class="farama-header__left--mobile">
          <label class="nav-overlay-icon" for="__navigation">
            <div class="visually-hidden">Toggle site navigation sidebar</div>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <defs></defs>
              <line x1="0.5" y1="4" x2="23.5" y2="4"></line>
              <line x1="0.232" y1="12" x2="23.5" y2="12"></line>
              <line x1="0.232" y1="20" x2="23.5" y2="20"></line>
            </svg>
          </label>
        </div>
        <div class="farama-header__left farama-header__center--mobile">
          <a href="../index.html">
              <img class="farama-header__logo only-light" src="../_static/img/darkgoat.png" alt="Light Logo"/>
              <img class="farama-header__logo only-dark" src="../_static/img/lightgoat.png" alt="Dark Logo"/>
            <span class="farama-header__title">free-range-zoo Documentation</span>
          </a>
        </div>
        <div class="farama-header__right">
          <div class="farama-header-menu">
              <!-- Fork of the Celshast template from the Farama Foundation  (breaks the header like this will reconsider attribution later) -->
          </div>
        </div>
      </div>
    </header>

    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="page">
  <!--<header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">free-range-zoo Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>-->
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="farama-sidebar__title" href="../index.html">
      <img class="farama-header__logo only-light" src="../_static/img/darkgoat.png" alt="Light Logo"/>
      <img class="farama-header__logo only-dark" src="../_static/img/lightgoat.png" alt="Dark Logo"/>
    <span class="farama-header__title">free-range-zoo Documentation</span>
  </a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/basic_usage.html">Basic Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environment API</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Environment API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/wildfire/index.html">Wildfire</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Wildfire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/wildfire/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/wildfire/baselines.html">Baselines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/cybersecurity/index.html">Cybersecurity</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Cybersecurity</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/cybersecurity/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/cybersecurity/baselines.html">Baselines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/rideshare/index.html">Rideshare</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Rideshare</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/rideshare/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/rideshare/baselines.html">Baselines</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/oasys-mas/free-range-zoo">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main-container">

    

    

    <div class="main">
      <div class="content">
        <div class="article-container">
          <a href="#" class="back-to-top muted-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
            </svg>
            <span>Back to top</span>
          </a>
          <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
              <button class="theme-toggle" title="Toggle color theme">
                <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                <svg class="theme-icon-when-auto">
                  <use href="#svg-sun-half"></use>
                </svg>
                <svg class="theme-icon-when-dark">
                  <use href="#svg-moon"></use>
                </svg>
                <svg class="theme-icon-when-light">
                  <use href="#svg-sun"></use>
                </svg>
              </button>
            </div>
            <label class="toc-overlay-icon toc-content-icon" for="__toc">
              <div class="visually-hidden">Toggle table of contents sidebar</div>
              <i class="icon"><svg>
                  <use href="#svg-toc"></use>
                </svg></i>
            </label>
          </div>
          <article role="main">
            
            <section class="tex2jax_ignore mathjax_ignore" id="environment-api">
<h1>Environment API<a class="headerlink" href="#environment-api" title="Link to this heading">¶</a></h1>
<p>Here we describe the schema of a <code class="docutils literal notranslate"><span class="pre">free-range-zoo</span></code> environment focusing on the differences between a <code class="docutils literal notranslate"><span class="pre">free-range-zoo</span></code>
environment and a <code class="docutils literal notranslate"><span class="pre">pettingzoo</span></code> environment.</p>
<section id="state">
<h2>State<a class="headerlink" href="#state" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Summary: Construct a State object. Instantiated into <code class="docutils literal notranslate"><span class="pre">env._state</span></code>, to store features of the current state observations and any hidden needed by the environment.</p>
</div></blockquote>
<section id="states-vs-transition-lookups">
<h3>States vs Transition lookups<a class="headerlink" href="#states-vs-transition-lookups" title="Link to this heading">¶</a></h3>
<p>To exploit the GPU and avoid OOMs rather than loading the whole statespace of an environment and implement the transition function as a lookup table we calculate state transitions step to step.</p>
<p>This means a few things,</p>
<ol class="arabic simple">
<li><p>We have a fast startup time as we do not need to precalculate all possible states or spend time loading them.</p></li>
<li><p>We don’t have a large memory overhead from caching all possible states, and thus we can scale a state space infinitely and still remain tractable so long as a single state is tractable.</p></li>
<li><p>We will almost always be slower in execution then a lookup table style transition function. See <a class="reference internal" href="#"><span class="xref myst">caching roadmap</span></a> where we intend to use a Rust implemented multi-level LRU cache, caching into a file to allow for caching of the most used states. <strong>Importantly still not calculating all possible</strong>.</p></li>
</ol>
<p>And most importantly here <strong>the next state must be constructed from the prior state</strong>. We will discuss this more in <a class="reference internal" href="#"><span class="xref myst">transitions</span></a>, but for now keep this in mind.</p>
<p>To concisely store the state we use a state dataclass for each environment and recommend that the components of this dataclass is a tensor. For instance wildfire’s state:</p>
<!-- TODO autoparse this -->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">WildfireState</span><span class="p">(</span><span class="n">State</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Representation of the wildfire environment state</span>

<span class="sd">    Fire Attributes:</span>
<span class="sd">        fires: torch.Tensor - Tensor representing the fire intensity of each cell</span>
<span class="sd">        intensity: torch.Tensor - Tensor representing the intensity of each fire</span>
<span class="sd">        fuel: torch.Tensor - Tensor representing the fuel remaining in each cell</span>
<span class="sd">    Agent Attributes:</span>
<span class="sd">        agents: torch.Tensor - Tensor representing the location of each agent</span>
<span class="sd">        suppressants: torch.Tensor - Tensor representing the suppressant of each agent</span>
<span class="sd">        capacity: torch.Tensor - Tensor representing the maximum suppressant of each agent</span>
<span class="sd">        equipment: torch.Tensor - Tensor representing the power of each agent</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fires</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">intensity</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">fuel</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>

    <span class="n">agents</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">suppressants</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">equipment</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the state at the specified indices</span>

<span class="sd">        Args:</span>
<span class="sd">            indices: torch.Tensor - Indices to get the state at</span>
<span class="sd">        Returns:</span>
<span class="sd">            WildfireState - State at the specified indices</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">WildfireState</span><span class="p">(</span><span class="n">fires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fires</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                             <span class="n">intensity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                             <span class="n">fuel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fuel</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                             <span class="n">agents</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">,</span>
                             <span class="n">suppressants</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">suppressants</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                             <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                             <span class="n">equipment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">equipment</span><span class="p">[</span><span class="n">indices</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the hash of the state</span>

<span class="sd">        Returns:</span>
<span class="sd">            int - Hash of the state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fires</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressants</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">equipment</span><span class="p">)</span>
        <span class="n">hashables</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">optimized_convert_hashable</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="n">hashables</span><span class="p">)</span>
</pre></div>
</div>
<p>Each state must be hashable so it can be cached. Pytorch tensors’ are immutable nonhashable objects. To get around this we offer a tensor hashing algorithm <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">free_range_zoo.utils.caching</span> <span class="pre">import</span> <span class="pre">optimized_convert_hashable</span></code> which you can use.</p>
</section>
<section id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">¶</a></h3>
<p>During <code class="docutils literal notranslate"><span class="pre">reset</span></code> and <code class="docutils literal notranslate"><span class="pre">reset_batches</span></code> the <code class="docutils literal notranslate"><span class="pre">self._state</span></code> needs to be set to its initial values. These values, if randomly generated, should only use torch randomness.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span>
        <span class="o">...</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Summary: Construct Configuration objects to organize your environment parameters.</p>
</div></blockquote>
<p>Openness typically adds many additional parameters to environments. This makes for a very complex <code class="docutils literal notranslate"><span class="pre">__init__</span></code> which is difficult to interprete. <code class="docutils literal notranslate"><span class="pre">Configurations</span></code> are our solution to this. We split environment parameters into groups of dataclasses, and use one <code class="docutils literal notranslate"><span class="pre">configuration</span></code> parameter for the environment to read them all.</p>
<p>For instance in <a class="reference internal" href="#"><span class="xref myst">Wildfire</span></a> we have a <code class="docutils literal notranslate"><span class="pre">fire_config</span></code> which controls fire settings, <code class="docutils literal notranslate"><span class="pre">agent_config</span></code> for agents, <code class="docutils literal notranslate"><span class="pre">reward_config</span></code>, and a <code class="docutils literal notranslate"><span class="pre">stochastic_config</span></code> for stochastic fire intensity changes and other probablistic parameters. See below the <code class="docutils literal notranslate"><span class="pre">RewardConfiguration</span></code> as a example.</p>
<!-- TODO auto read this -->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">RewardConfiguration</span><span class="p">(</span><span class="n">Configuration</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Settings for configuring the reward function.</span>

<span class="sd">    fire_rewards: torch.FloatTensor - Reward for extinguishing a fire</span>
<span class="sd">    bad_attack_penalty: float - Penalty for attacking a tile that is not on fire</span>
<span class="sd">    burnout_penalty: float - Penalty for attacking a burned out fire</span>
<span class="sd">    termination_reward: float - Reward for terminating the environment</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fire_rewards</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span>
    <span class="n">bad_attack_penalty</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">burnout_penalty</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">termination_reward</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the configuration to ensure logical consistency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool - True if the configuration is valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fire_rewards</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;fire_rewards should be a 2D tensor&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>We then use an aggregate Configuration that is given to the environment. This lets us perform validation that is general across all parameter groups. Other functions can be added which create derivatives from the parameters, like the fire_spread convolutional weights for wildfire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">WildfireConfiguration</span><span class="p">(</span><span class="n">Configuration</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the wildfire environment.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        grid_width: int - Width of the grid</span>
<span class="sd">        grid_height: int - Height of the grid</span>
<span class="sd">    Configuration Attributes:</span>
<span class="sd">        fire_configuration: FireConfiguration - Configuration for the fire properties</span>
<span class="sd">        agent_configuration: AgentConfiguration - Configuration for the agent properties</span>
<span class="sd">        reward_configuration: RewardConfiguration - Configuration for the environment rewards</span>
<span class="sd">        stochastic_configuration: StochasticConf - Configuration for the stochastic elements</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">grid_width</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">grid_height</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">fire_config</span><span class="p">:</span> <span class="n">FireConfiguration</span>
    <span class="n">agent_config</span><span class="p">:</span> <span class="n">AgentConfiguration</span>
    <span class="n">reward_config</span><span class="p">:</span> <span class="n">RewardConfiguration</span>
    <span class="n">stochastic_config</span><span class="p">:</span> <span class="n">StochasticConfiguration</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">cached_property</span>
    <span class="k">def</span> <span class="nf">fire_spread_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the fire spread weights with the current fire and stochastic configuration.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_config</span><span class="o">.</span><span class="n">fire_spread</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_config</span><span class="o">.</span><span class="n">realistic_fire_spread</span><span class="p">:</span>
            <span class="n">Ns</span><span class="p">,</span> <span class="n">Es</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">Ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fire_config</span><span class="o">.</span><span class="n">realistic_spread_rates</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_config</span><span class="o">.</span><span class="n">realistic_fire_spread</span><span class="p">:</span>
            <span class="n">Ns</span><span class="p">,</span> <span class="n">Es</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">Ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fire_config</span><span class="o">.</span><span class="n">realistic_spread_rates</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Ns</span><span class="p">,</span> <span class="n">Es</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">Ws</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fire_config</span><span class="o">.</span><span class="n">base_spread_rate</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>

        <span class="n">fire_filter</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Ns</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Ws</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Es</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_config</span><span class="o">.</span><span class="n">random_fire_ignition</span><span class="p">:</span>
            <span class="n">fire_filter</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">fire_filter</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fire_config</span><span class="o">.</span><span class="n">random_ignition_probability</span>

        <span class="k">return</span> <span class="n">fire_filter</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the configuration to ensure logical consistency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool - True if the configuration is valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_width</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;grid_width should be greater than 0&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_height</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;grid_height should be greater than 0&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fire_config</span><span class="o">.</span><span class="n">lit</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward_config</span><span class="o">.</span><span class="n">fire_rewards</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;lit and fire_rewards should have the same shape&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Summary: Implement the <code class="docutils literal notranslate"><span class="pre">update_actions</span></code> and <code class="docutils literal notranslate"><span class="pre">action_space</span></code> functions. These updates the expected actions, and construct the Gymnasium action spaces for the environment.</p>
</div></blockquote>
<section id="task-agnostic-actions-vs-task-actions">
<h3>Task-Agnostic Actions vs Task-Actions<a class="headerlink" href="#task-agnostic-actions-vs-task-actions" title="Link to this heading">¶</a></h3>
<p>Each of our domains utilize a <code class="docutils literal notranslate"><span class="pre">OneOf</span></code> space to indicate different tasks’ action spaces.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#See a list of task-action spaces grouped into a OneOf space</span>
<span class="n">OneOf</span><span class="p">([</span>
    <span class="n">Discrete</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="c1">#a fire we can Attack:0</span>
    <span class="n">Discrete</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># a fire we can Attack:0 or Hold back:1</span>
    <span class="c1">#(Hold back doesn&#39;t exist in wildfire)</span>
<span class="p">])</span>
</pre></div>
</div>
<p>Here a action space is the set of available actions an agent can take, and a <strong>task-action space</strong> is the set of actions that an agent can take for a specific task. There also exist <strong>task-agnostic</strong> actions, such as <em>NOOP</em>, which can be performed irrespective of a task.</p>
<p>We indicate a action is <strong>task-agnostic</strong> by giving it a negative integer/float value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Discrete</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">start</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#NOOP</span>
</pre></div>
</div>
<p>Tasks are then identified by the index of the space used. Spaces can be overlapping, and this still works because <span class="math notranslate nohighlight">\(OneOf.sample()\to space\_index, sampled\_value\)</span>. Specifically the <strong>index of the space within OneOf excluding any spaces that contain negatives</strong>.</p>
<blockquote>
<div><p>Task-agnostic actions can be listed as seperate spaces within the OneOf, but they must contain only other task-agnostic actions!</p>
</div></blockquote>
</section>
<section id="id1">
<h3>Implementation<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#DO NOT FORGET TO ADD A NO_GRAD TO EACH FUNCTION.</span>
<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">update_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batches</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates which tasks should be considered for which agent and batch.</span>
<span class="sd">    Updates which actions should be considered for which task, agent, and batch.</span>

<span class="sd">    Ideally this should be a vectorized function implemented strictly on self.device</span>

<span class="sd">    This function should be called:</span>
<span class="sd">    - At the end of raw_env.__init__()</span>
<span class="sd">    - After step()  ?we do this for you</span>
<span class="sd">    - After reset()</span>
<span class="sd">    - After reset_batches() ?this can provide a optional parameter batches:List[int] which determines a subset of batches to update the actions of.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>

<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">action_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">gymnasium</span><span class="o">.</span><span class="n">Space</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the action space for the given agent.</span>
<span class="sd">    This typically cannot be vectorized.</span>
<span class="sd">    This should call a function from env/spaces/actions.py rather than being implemented here for cleanliness.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent: str - the name of the agent to retrieve the action space for</span>
<span class="sd">    Returns:</span>
<span class="sd">        List[gymnasium.Space]: the action space for the given agent. The list indicates batches</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="observations">
<h2>Observations<a class="headerlink" href="#observations" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Summary: Implement the <code class="docutils literal notranslate"><span class="pre">update_observations</span></code> and <code class="docutils literal notranslate"><span class="pre">observation_space</span></code> functions. These generate the output observations, and construct the Gymnasium observation spaces for the environment.</p>
</div></blockquote>
<section id="dictionaries">
<h3>Dictionaries<a class="headerlink" href="#dictionaries" title="Link to this heading">¶</a></h3>
<p>Each of our domains use a <code class="docutils literal notranslate"><span class="pre">dictionary</span></code> space with the observations themselves being a <a class="reference internal" href="#"><span class="xref myst">tensordict</span></a>. These dictionaries follow the same structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="c1">#&lt;#agent features&gt;</span>
    <span class="s1">&#39;self&#39;</span><span class="p">:</span> <span class="n">This</span> <span class="n">agents</span> <span class="n">observations</span><span class="p">,</span>

    <span class="c1">#&lt;#Agents present/visible -1, #agent features&gt;</span>
    <span class="s1">&#39;others&#39;</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">(</span> <span class="n">other</span> <span class="n">agent</span> <span class="n">observation</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">last</span> <span class="n">other</span> <span class="n">agent</span> <span class="n">obs</span> <span class="p">),</span>

    <span class="c1">#&lt;#tasks present/visible, #task features&gt;</span>
    <span class="s1">&#39;tasks&#39;</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">(</span> <span class="n">task</span> <span class="n">observation</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">last</span> <span class="n">task</span> <span class="n">observation</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">batch_dim</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#for the observation, for the spaces, this is in a list</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">others</span></code> and <code class="docutils literal notranslate"><span class="pre">tasks</span></code> are <a class="reference internal" href="#"><span class="xref myst">Tuple</span></a> spaces to allow for agent and task openness. Agent inference should not depend on the position of tasks and agents within these tuples. When tasks and agents leave/enter their positions will shift.</p>
</section>
<section id="id2">
<h3>Implementation<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">update_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the observations for each agent and batch.</span>
<span class="sd">    This should be vectorized.</span>

<span class="sd">    This should set the self.observations attribute to be the current observations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#for example if our state has &#39;agents&#39; which contains all agent observations</span>
    <span class="c1"># and &#39;tasks&#39; which contains all tasks for each agent.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">observations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">agent</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">({</span>
            <span class="s1">&#39;self&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">][</span><span class="n">agent</span><span class="p">],</span>
            <span class="s1">&#39;others&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">agent</span><span class="p">],</span>
            <span class="s1">&#39;tasks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">][</span><span class="n">agent</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">agents</span><span class="p">}</span>


<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">observation_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">gymnasium</span><span class="o">.</span><span class="n">Space</span><span class="p">]:</span>
    <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Return the observation space for the given agent.</span>
<span class="s2">    This typically cannot be vectorized.</span>
<span class="s2">    This should call a function from env/spaces/observations.py rather than being implemented here for cleanliness.</span>

<span class="s2">    Args:</span>
<span class="s2">        agent: str - the name of the agent to retrieve the observation space for</span>
<span class="s2">    Returns:</span>
<span class="s2">        List[gymnasium.Space]: the observation space for the given agent</span>
</pre></div>
</div>
</section>
</section>
</section>

          </article>
        </div>
        <footer>
          
          <div class="related-pages">
            <a class="next-page" href="../environments/wildfire/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Wildfire</div>
              </div>
              <svg class="furo-related-icon">
                <use href="#svg-arrow-right"></use>
              </svg>
            </a>
            <a class="prev-page" href="environments.html">
              <svg class="furo-related-icon">
                <use href="#svg-arrow-right"></use>
              </svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Environment API</div>
                
              </div>
            </a>
          </div>
          <div class="bottom-of-page">
            <div class="left-details">
              <div class="copyright">
                Copyright &#169; 1980, University of Georgia, University of Nebraska, Oberlin College
              </div>
              <!--
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            -->
            </div>
            <div class="right-details">
              <div class="icons">
                
              </div>
            </div>
          </div>
          
        </footer>
      </div>
      <aside class="toc-drawer">
        
        
        <div class="toc-sticky toc-scroll">
          <div class="toc-title-container">
            <span class="toc-title">
              On this page
            </span>
          </div>
          <div class="toc-tree-container">
            <div class="toc-tree">
              <ul>
<li><a class="reference internal" href="#">Environment API</a><ul>
<li><a class="reference internal" href="#state">State</a><ul>
<li><a class="reference internal" href="#states-vs-transition-lookups">States vs Transition lookups</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configurations">Configurations</a></li>
<li><a class="reference internal" href="#actions">Actions</a><ul>
<li><a class="reference internal" href="#task-agnostic-actions-vs-task-actions">Task-Agnostic Actions vs Task-Actions</a></li>
<li><a class="reference internal" href="#id1">Implementation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#observations">Observations</a><ul>
<li><a class="reference internal" href="#dictionaries">Dictionaries</a></li>
<li><a class="reference internal" href="#id2">Implementation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
        
        
      </aside>
    </div>
  </div>
</div>
    <!-- <script>
      const toggleMenu = () => {
        const menuBtn = document.querySelector(".farama-header-menu__btn");
        const menuContainer = document.querySelector(".farama-header-menu-container");
        if (document.querySelector(".farama-header-menu").classList.contains("active")) {
          menuBtn.setAttribute("aria-expanded", "false");
          menuContainer.setAttribute("aria-hidden", "true");
        } else {
          menuBtn.setAttribute("aria-expanded", "true");
          menuContainer.setAttribute("aria-hidden", "false");
        }
        document.querySelector(".farama-header-menu").classList.toggle("active");
      }

      document.querySelector(".farama-header-menu__btn").addEventListener("click", toggleMenu);
      document.getElementById("farama-close-menu").addEventListener("click", toggleMenu);
    </script> -->

    
    

    <script src="../_static/documentation_options.js?v=c5e1e573"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=7660844c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!--
    <script>

      const createProjectsList = (projects, displayImages) => {
        const ulElem = Object.assign(document.createElement('ul'),
          {
            className:'farama-header-menu-list',
          }
        )
        for (let project of projects) {
          const liElem = document.createElement("li");
          const aElem = Object.assign(document.createElement("a"),
            {
              href: project.link
            }
          );
          liElem.appendChild(aElem);
          if (displayImages) {
            const imgElem = Object.assign(document.createElement("img"),
              {
                src: project.image ? imagesBasepath + project.image : imagesBasepath + "/farama_black.svg",
                alt: `${project.name} logo`,
                className: "farama-black-logo-invert"
              }
            );
            aElem.appendChild(imgElem);
          }
          aElem.appendChild(document.createTextNode(project.name));
          ulElem.appendChild(liElem);
        }
        return ulElem;
      }

      // Create menu with Farama projects by using the API at farama.org/api/projects.json
      const createCORSRequest = (method, url) => {
        let xhr = new XMLHttpRequest();
        xhr.responseType = 'json';

        if ("withCredentials" in xhr) {
          xhr.open(method, url, true);
        } else if (typeof XDomainRequest != "undefined") {
          // IE8 & IE9
          xhr = new XDomainRequest();
          xhr.open(method, url);
        } else {
          // CORS not supported.
          xhr = null;
        }
        return xhr;
      };

      const url = 'https://farama.org/api/projects.json';
      const imagesBasepath = "https://farama.org/assets/images"
      const method = 'GET';
      let xhr = createCORSRequest(method, url);

      xhr.onload = () => {
        const jsonResponse = xhr.response;
        const sections = {
          "Core Projects": [],
          "Mature Projects": {
            "Documentation": [],
            "Repositories": [],
          },
          "Incubating Projects": {
            "Documentation": [],
            "Repositories": [],
          },
          "Foundation": [
            {
              name: "About",
              link: "https://farama.org/about"
            },
            {
              name: "Standards",
              link: "https://farama.org/project_standards",
            },
            {
              name: "Donate",
              link: "https://farama.org/donations"
            }
          ]
        }

        // Categorize projects
        Object.keys(jsonResponse).forEach(key => {
          projectJson = jsonResponse[key];
          if (projectJson.website !== null) {
            projectJson.link = projectJson.website;
          } else {
            projectJson.link = projectJson.github;
          }
          if (projectJson.type === "core") {
            sections["Core Projects"].push(projectJson)
          } else if (projectJson.type == "mature") {
            if (projectJson.website !== null) {
              sections["Mature Projects"]["Documentation"].push(projectJson)
            } else {
              sections["Mature Projects"]["Repositories"].push(projectJson)
            }
          } else {
            if (projectJson.website !== null) {
              sections["Incubating Projects"]["Documentation"].push(projectJson)
            } else {
              sections["Incubating Projects"]["Repositories"].push(projectJson)
            }
          }
        })

        const menuContainer = document.querySelector(".farama-header-menu__body");

        Object.keys(sections).forEach((key, i) => {
          const sectionElem = Object.assign(
            document.createElement('div'), {
              className:'farama-header-menu__section',
            }
          )
          sectionElem.appendChild(Object.assign(document.createElement('span'),
            {
              className:'farama-header-menu__section-title' ,
              innerText: key
            }
          ))
          // is not a list
          if (sections[key].constructor !== Array) {
            const subSections = sections[key];
            const subSectionContainerElem = Object.assign(
                document.createElement('div'), {
                  className:'farama-header-menu__subsections-container',
                  style: 'display: flex'
                }
            )
            Object.keys(subSections).forEach((subKey, i) => {
              const subSectionElem = Object.assign(
                document.createElement('div'), {
                  className:'farama-header-menu__subsection',
                }
              )
              subSectionElem.appendChild(Object.assign(document.createElement('span'),
                {
                  className:'farama-header-menu__subsection-title' ,
                  innerText: subKey
                }
              ))
              const ulElem = createProjectsList(subSections[subKey], key !== 'Foundation');
              subSectionElem.appendChild(ulElem);
              subSectionContainerElem.appendChild(subSectionElem);
            })
            sectionElem.appendChild(subSectionContainerElem);
          } else {
            const projects = sections[key];
            const ulElem = createProjectsList(projects, true);
            sectionElem.appendChild(ulElem);
          }
          menuContainer.appendChild(sectionElem)
        });
      }

      xhr.onerror = function() {
        console.error("Unable to load projects");
      };

      xhr.send();
    </script>
  -->

    
    

    </body>
</html>